<div class="container">
  <div class="row mt-3">
    <div class="col-3 mt-3 mb-3">
      <h5 class="text-center bg-light">マイページ</h5>
    </div>
  </div>

  <div class="row">
    <h5 class="font-weight-bold">登録情報</h5>
    <div class="offset-1">
      <% if @end_user.nick_name != "ゲストユーザー" %>
        <%= link_to "編集する", edit_user_path(@end_user), class: "btn btn-sm btn-success" %>
      <% end %>
    </div>
  </div>
  <div class="text-center">
    <div class="row mt-3 mb-4 ml-5">
      <table class="table-bordered col-10">
        <tr>
          <th class="bg-light p-3" style="width: 400px">プロフィール画像</th>
          <td><%= image_tag @end_user.get_profile_image, class:"rounded-circle", size: '50x50' %></td>
        </tr>
        <tr>
          <th class="bg-light p-3">ニックネーム</th>
          <td><%= @end_user.nick_name %></td>
        </tr>
        <tr>
          <th class="bg-light p-3">メールアドレス</th>
          <td><%= @end_user.email %></td>
        </tr>
      </table>
    </div>
  </div>

  <div class="row mt-2 mb-4">
    <div class="col-md-6">
      <h5 class="font-weight-bold">投稿一覧</h5>
      <% @post_user.each do |post| %>
        <div class="card mb-3 mt-3">
          <div class="card-header shadow-sm bg-white">
            <%= image_tag @end_user.get_profile_image, class:"mr-4 rounded-circle", size: '50x50' %>
            <sapn class="font-weight-bold"><%= post.end_user.nick_name %></sapn>
            <span class="float-right mt-2"><i class="fa fa-comment"></i> <%= post.post_comments.count %>
            <span class="ml-3">
              <% if post.favorited_by?(current_end_user) %>
                <i class="fa fa-heart" aria-hidden="true"></i> <%= post.favorites.count %>
              <% else %>
                <i class="fa fa-heart" aria-hidden="true"></i> <%= post.favorites.count %>
              <% end %>
            </span>
            <% if post.end_user == current_end_user %>
            <span class="ml-3"><%= link_to "削除", post_path(post), class:"text-danger font-weight-bolder card-hover", method: :delete %></span>
            <% end %>
            <span class="ml-3"><i class="fa fa-calendar mr-2"></i><%= post.created_at.strftime('%Y/%m/%d') %></span>
          </span>
          </div>
          <div class="card-body">
            <%= link_to post_path(post.id), class: "card-hover" do %>
            <div class="row text-dark">
              <div class="<%= post.get_image.blank? ? 'col-md-12' : 'col-md-6' %>">
                <%= post.caption %>
              </div>
              <% unless post.get_image.blank? %>
                <div class="col-md-6">
                  <%= image_tag post.get_image, size: '300x200', class: 'img-fluid d-block mx-auto' %>
                </div>
              <% end %>
              </div>
            <% end %>
          </div>
        </div>
    <% end %>
    </div>
    <div class="col-md-6">
      <h5 class="font-weight-bold">いいね一覧</h5>
      <% @post_favorites.each do |favorite| %>
        <div class="card mb-3 mt-3">
          <div class="card-header shadow-sm bg-white">
            <%= image_tag favorite.post.end_user.get_profile_image, class:"mr-4 rounded-circle", size: '50x50' %>
            <sapn class="font-weight-bold"><%= favorite.post.end_user.nick_name %></sapn>
            <span class="float-right mt-2"><i class="fa fa-comment"></i> <%= favorite.post.post_comments.count %>
            <span class="ml-3">
              <% if favorite.post.favorited_by?(current_end_user) %>
                <i class="fa fa-heart" aria-hidden="true"></i> <%= favorite.post.favorites.count %>
              <% else %>
                <i class="fa fa-heart" aria-hidden="true"></i> <%= favorite.post.favorites.count %>
              <% end %>
            </span>
            <% if favorite.post.end_user == current_end_user %>
            <span class="ml-3"><%= link_to "削除", post_path(favorite.post), class:"text-danger font-weight-bolder card-hover", method: :delete %></span>
            <% end %>
            <span class="ml-3"><i class="fa fa-calendar mr-2"></i><%= favorite.post.created_at.strftime('%Y/%m/%d') %></span>
          </span>
          </div>
          <div class="card-body">
            <%= link_to post_path(favorite.post.id), class: "card-hover" do %>
            <div class="row text-dark">
              <div class="<%= favorite.post.get_image.blank? ? 'col-md-12' : 'col-md-6' %>">
                <%= favorite.post.caption %>
              </div>
              <% unless favorite.post.get_image.blank? %>
                <div class="col-md-6">
                  <%= image_tag favorite.post.get_image, size: '300x200', class: 'img-fluid d-block mx-auto' %>
                </div>
              <% end %>
              </div>
            <% end %>
          </div>
        </div>
    <% end %>
    </div>
  </div>
</div>